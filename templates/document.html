<div class="container">
  <a href="/" class="back-link">← Назад к списку</a>
  <h1 class="doc-title">{{ doc.file_name }} {% if doc.name %} — {{ doc.name }}{% endif %}</h1>
  <p class="doc-meta">id: {{ doc.id }} — создан: {{ doc.created_at or "-" }}</p>

  <h2>Оригинальный текст</h2>
  <pre class="original">{{ doc.original_text }}</pre>

  <h2>Сводки</h2>

  {% for title, div_id, summary in [
      ('LLM Text Summary', 'llm_text', doc.summary.llm_text_summary),
      ('Extraction Text Summary', 'extr_text', doc.summary.extraction_text_summary),
      ('LLM Keyword Tree', 'llm_kw', doc.summary.llm_keyword_summary),
      ('Extraction Keyword Tree', 'extr_kw', doc.summary.extraction_keyword_summary)
  ] %}
    <div class="summary-block">
      <button onclick="toggle('{{ div_id }}')" class="toggle-btn">{{ title }}</button>
      <div id="{{ div_id }}" class="collapsible">
        {% if 'Text' in title %}
          <h3>RU</h3><p>{{ summary.ru }}</p>
          <h3>EN</h3><p>{{ summary.en }}</p>
        {% else %}
          <ul class="kw-tree">
            {% macro render_node(node) -%}
              <li>{{ node.keyword }}
                {% if node.children %}
                  <ul>
                    {% for c in node.children %}
                      {{ render_node(c) }}
                    {% endfor %}
                  </ul>
                {% endif %}
              </li>
            {%- endmacro %}
            {{ render_node(summary.ru) }}
          </ul>
        {% endif %}
      </div>
    </div>
  {% endfor %}

  <form action="/documents/{{ doc.id }}/delete" method="post" style="margin-top:1em;">
    <button type="submit" class="delete-btn" onclick="return confirm('Удалить документ?')">Удалить документ</button>
  </form>
</div>
